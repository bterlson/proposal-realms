{"version":3,"file":"realm-shim.min.js","sources":["../src/sandbox.js","../src/sanitize.js","../src/proxy.js","../src/evaluate.js","../src/evaluators.js","../src/intrinsics.js","../src/stdlib.js","../src/realm.js"],"sourcesContent":["function createIframe() {\n    const el = document.createElement(\"iframe\");\n    el.style.display = \"none\";\n    // accessibility\n    el.title = \"script\";\n    el.setAttribute('aria-hidden', true);\n    document.body.appendChild(el);\n    return el;\n}\n\nexport function createSandbox(customGlobalObj, customThisValue) {\n    const iframe = createIframe();\n    const { contentDocument: iframeDocument, contentWindow: confinedWindow } = iframe;\n    const globalObject = customGlobalObj || confinedWindow.Object.create(null);\n    const thisValue = customThisValue || globalObject;\n    return {\n        iframe,\n        iframeDocument,\n        confinedWindow,\n        thisValue,\n        globalObject,\n        globalProxy: undefined,\n    };\n}","// locking down the environment\nexport function sanitize(sandbox) {\n    const { confinedWindow: { Object: o } } = sandbox;\n    try {\n        // Fixing properties of Object to comply with strict mode\n        // and ES2016 semantics, we do this by redefining them while in 'use strict'\n        // https://tc39.github.io/ecma262/#sec-object.prototype.__defineGetter__\n        if (o === undefined) {\n            return;\n        }\n        o.defineProperty(o.prototype, '__defineGetter__', {\n            value: function (key, fn) {\n                return o.defineProperty(this, key, {\n                    get: fn\n                });\n            }\n        });\n        o.defineProperty(o.prototype, '__defineSetter__', {\n            value: function (key, fn) {\n                return o.defineProperty(this, key, {\n                    set: fn\n                });\n            }\n        });\n        o.defineProperty(o.prototype, '__lookupGetter__', {\n            value: function (key) {\n                var d, p = this;\n                while (p && (d = o.getOwnPropertyDescriptor(p, key)) === undefined) {\n                    p = o.getPrototypeOf(this);\n                }\n                return d ? d.get : undefined;\n            }\n        });\n        o.defineProperty(o.prototype, '__lookupSetter__', {\n            value: function (key) {\n                var d, p = this;\n                while (p && (d = o.getOwnPropertyDescriptor(p, key)) === undefined) {\n                    p = o.getPrototypeOf(this);\n                }\n                return d ? d.set : undefined;\n            }\n        });\n        // Immutable Prototype Exotic Objects\n        // https://github.com/tc39/ecma262/issues/272\n        o.seal(o.prototype);\n    } catch (ignore) {\n        // Ignored\n    }\n}","// this flag allow us to determine if the eval() call is a controlled eval done by the realm's code\n// or if it is user-land invocation, so we can react differently.\nlet isInternalEvaluation = false;\n\nexport function setInternalEvaluation() {\n    isInternalEvaluation = true;\n}\n\nexport function resetInternalEvaluation() {\n    isInternalEvaluation = false;\n}\n\nexport const proxyHandler = {\n    get(sandbox, propName) {\n        if (propName === 'eval' && isInternalEvaluation) {\n            resetInternalEvaluation();\n            return sandbox.confinedWindow.eval;\n        }\n        return sandbox.globalObject[propName];\n    },\n    set(sandbox, propName, newValue) {\n        sandbox.globalObject[propName] = newValue;\n        return true;\n    },\n    defineProperty(sandbox, propName, descriptor) {\n        Object.defineProperty(sandbox.globalObject, propName, descriptor);\n        return true;\n    },\n    deleteProperty(sandbox, propName) {\n        return Reflect.deleteProperty(sandbox.globalObject, propName);\n    },\n    has(sandbox, propName) {\n        if (propName === 'eval' && isInternalEvaluation) {\n            return true;\n        }\n        if (propName in sandbox.globalObject) {\n            return true;\n        } else if (propName in sandbox.confinedWindow) {\n            throw new ReferenceError(`${propName} is not defined. If you are using typeof ${propName}, you can change your program to use typeof global.${propName} instead`);\n        }\n        return false;\n    },\n    ownKeys(sandbox) {\n        return Object.getOwnPropertyNames(sandbox.globalObject);\n    },\n    getOwnPropertyDescriptor(sandbox, propName) {\n        return Object.getOwnPropertyDescriptor(sandbox.globalObject, propName);\n    },\n    isExtensible(sandbox) {\n        // TODO: can it becomes non-extensible?\n        return true;\n    },\n    getPrototypeOf(sandbox) {\n        return null;\n    },\n    setPrototypeOf(sandbox, prototype) {\n        return prototype === null ? true : false;\n    },\n};","import {\n    setInternalEvaluation,\n    resetInternalEvaluation,\n} from \"./proxy\";\n\nconst HookFnName = '$RealmEvaluatorIIFE$';\n\n// Wrapping the source with `with` statement creates a new lexical scope,\n// that can prevent access to the globals in the sandbox by shadowing them\n// via globalProxy.\nfunction addLexicalScopesToSource(sourceText) {\n    /**\n     * We use a `with` statement who uses `argments[0]`, which is the\n     * `sandbox.globalProxy` that implements the shadowing mechanism as well as access to\n     * any global variable.\n     * Aside from that, the `this` value in sourceText will correspond to `sandbox.thisValue`.\n     * We have to use `arguments` instead of naming them to avoid name collision.\n     */\n    // escaping backsticks to prevent leaking the original eval as well as syntax errors\n    sourceText = sourceText.replace(/\\`/g, '\\\\`');\n    return `\n        function ${HookFnName}() {\n            with(arguments[0]) {\n                return (function(){\n                    \"use strict\";\n                    return eval(\\`${sourceText}\\`);\n                }).call(this);\n            }\n        }\n    `;\n}\n\nfunction evalAndReturn(sourceText, sandbox) {\n    const { iframeDocument, confinedWindow } = sandbox;\n    const { body: iframeBody } = iframeDocument;\n    const script = iframeDocument.createElement('script');\n    script.type = 'text/javascript';\n    confinedWindow[HookFnName] = undefined;\n    script.appendChild(iframeDocument.createTextNode(sourceText));\n    iframeBody.appendChild(script);\n    iframeBody.removeChild(script);\n    const result = confinedWindow[HookFnName];\n    confinedWindow[HookFnName] = undefined;\n    return result;\n}\n\nexport function evaluate(sourceText, sandbox) {\n    if (!sourceText) {\n        return undefined;\n    }\n    sourceText = addLexicalScopesToSource(sourceText + '');\n    setInternalEvaluation();\n    const fn = evalAndReturn(sourceText, sandbox);\n    const result = fn.apply(sandbox.thisValue, [sandbox.globalProxy]);\n    resetInternalEvaluation();\n    return result;\n}","import { evaluate } from \"./evaluate\";\n\nfunction getEvalEvaluator(sandbox) {\n    const o = {\n        // trick to set the name of the function to \"eval\"\n        eval: function(sourceText) {\n            // console.log(`Shim-Evaluation: \"${sourceText}\"`);\n            return evaluate(sourceText, sandbox);\n        }\n    };\n    Object.setPrototypeOf(o.eval, sandbox.Function);\n    o.eval.toString = () => 'function eval() { [shim code] }';\n    return o.eval;\n}\n\nfunction getFunctionEvaluator(sandbox) {\n    const { confinedWindow } = sandbox;\n    const f = function Function(...args) {\n        // console.log(`Shim-Evaluation: Function(\"${args.join('\", \"')}\")`);\n        const sourceText = args.pop();\n        const fnArgs = args.join(', ');\n        return evaluate(`(function anonymous(${fnArgs}){\\n${sourceText}\\n}).bind(this)`, sandbox);\n    }\n    f.prototype = confinedWindow.Function.prototype;\n    Object.setPrototypeOf(f, f.prototype);\n    f.prototype.constructor = f;\n    f.toString = () => 'function Function() { [shim code] }';\n    return f;\n}\n\nexport function getEvaluators(sandbox) {\n    sandbox.Function = getFunctionEvaluator(sandbox);\n    sandbox.eval = getEvalEvaluator(sandbox);\n}","import Realm from \"./realm\";\n\nconst iteratorSymbol = (typeof Symbol && Symbol.iterator) || \"@@iterator\";\n\nexport function getIntrinsics(sandbox) {\n    const { confinedWindow: _, globalObject } = sandbox;\n    const anonymousArrayIteratorPrototype = getProto(_.Array(0)[iteratorSymbol]());\n    const anonymousStringIteratorPrototype = getProto(_.String()[iteratorSymbol]());\n    const anonymousIteratorPrototype = getProto(anonymousArrayIteratorPrototype);\n\n    const strictArgumentsGenerator = _.eval('(function*(){\"use strict\";yield arguments;})');\n    const anonymousGenerator = getProto(strictArgumentsGenerator);\n    const anonymousGeneratorPrototype = getProto(anonymousGenerator);\n    const anonymousGeneratorFunction = anonymousGeneratorPrototype.constructor;\n\n    return {\n        // %Array%\n        \"Array\": _.Array,\n        // %ArrayBuffer%\n        \"ArrayBuffer\": _.ArrayBuffer,\n        // %ArrayBufferPrototype%\n        \"ArrayBufferPrototype\": _.ArrayBuffer.prototype,\n        // %ArrayIteratorPrototype%\n        \"ArrayIteratorPrototype\": anonymousArrayIteratorPrototype,\n        // %ArrayPrototype%\n        \"ArrayPrototype\": _.Array.prototype,\n        // %ArrayProto_values%\n        \"ArrayProto_values\": _.Array.prototype.values,\n        // %Boolean%\n        \"Boolean\": _.Boolean,\n        // %BooleanPrototype%\n        \"BooleanPrototype\": _.Boolean.prototype,\n        // %DataView%\n        \"DataView\": _.DataView,\n        // %DataViewPrototype%\n        \"DataViewPrototype\": _.DataView.prototype,\n        // %Date%\n        \"Date\": _.Date,\n        // %DatePrototype%\n        \"DatePrototype\": _.Date.prototype,\n        // %decodeURI%\n        \"decodeURI\": _.decodeURI,\n        // %decodeURIComponent%\n        \"decodeURIComponent\": _.decodeURIComponent,\n        // %encodeURI%\n        \"encodeURI\": _.encodeURI,\n        // %encodeURIComponent%\n        \"encodeURIComponent\": _.encodeURIComponent,\n        // %Error%\n        \"Error\": _.Error,\n        // %ErrorPrototype%\n        \"ErrorPrototype\": _.Error.prototype,\n        // %eval%\n        \"eval\": sandbox.eval,\n        // %EvalError%\n        \"EvalError\": _.EvalError,\n        // %EvalErrorPrototype%\n        \"EvalErrorPrototype\": _.EvalError.prototype,\n        // %Float32Array%\n        \"Float32Array\": _.Float32Array,\n        // %Float32ArrayPrototype%\n        \"Float32ArrayPrototype\": _.Float32Array.prototype,\n        // %Float64Array%\n        \"Float64Array\": _.Float64Array,\n        // %Float64ArrayPrototype%\n        \"Float64ArrayPrototype\": _.Float64Array.prototype,\n        // %Function%\n        \"Function\": sandbox.Function,\n        // %FunctionPrototype%\n        \"FunctionPrototype\": _.Function.prototype,\n        // %Generator%\n        \"Generator\": anonymousGenerator,\n        // %GeneratorFunction%\n        \"GeneratorFunction\": anonymousGeneratorFunction,\n        // %GeneratorPrototype%\n        \"GeneratorPrototype\": anonymousGeneratorPrototype,\n        // %Int8Array%\n        \"Int8Array\": _.Int8Array,\n        // %Int8ArrayPrototype%\n        \"Int8ArrayPrototype\": _.Int8Array.prototype,\n        // %Int16Array%\n        \"Int16Array\": _.Int16Array,\n        // %Int16ArrayPrototype%,\n        \"Int16ArrayPrototype\": _.Int16Array.prototype,\n        // %Int32Array%\n        \"Int32Array\": _.Int32Array,\n        // %Int32ArrayPrototype%\n        \"Int32ArrayPrototype\": _.Int32Array.prototype,\n        // %isFinite%\n        \"isFinite\": _.isFinite,\n        // %isNaN%\n        \"isNaN\": _.isNaN,\n        // %IteratorPrototype%\n        \"IteratorPrototype\": anonymousIteratorPrototype,\n        // %JSON%\n        \"JSON\": _.JSON,\n        // %Map%\n        \"Map\": _.Map,\n        // %MapIteratorPrototype%\n        \"MapIteratorPrototype\": undefined,\n        // %MapPrototype%\n        \"MapPrototype\": _.Map.prototype,\n        // %Math%\n        \"Math\": _.Math,\n        // %Number%\n        \"Number\": _.Number,\n        // %NumberPrototype%\n        \"NumberPrototype\": _.Number.prototype,\n        // %Object%\n        \"Object\": _.Object,\n        // %ObjectPrototype%\n        \"ObjectPrototype\": _.Object.prototype,\n        // %ObjProto_toString%\n        \"ObjProto_toString\": _.Object.prototype.toString,\n        // %ObjProto_valueOf%\n        \"ObjProto_valueOf\": _.Object.prototype.valueOf,\n        // %parseFloat%\n        \"parseFloat\": _.parseFloat,\n        // %parseInt%\n        \"parseInt\": _.parseInt,\n        // %Promise%\n        \"Promise\": _.Promise,\n        // %PromisePrototype%\n        \"PromisePrototype\": _.Promise.prototype,\n        // %Proxy%\n        \"Proxy\": _.Proxy,\n        // %RangeError%\n        \"RangeError\": _.RangeError,\n        // %RangeErrorPrototype%\n        \"RangeErrorPrototype\": _.RangeError.prototype,\n        // %ReferenceError%\n        \"ReferenceError\": _.ReferenceError,\n        // %ReferenceErrorPrototype%\n        \"ReferenceErrorPrototype\": _.ReferenceError.prototype,\n        // %Reflect%\n        \"Reflect\": _.Reflect,\n        // %RegExp%\n        \"RegExp\": _.RegExp,\n        // %RegExpPrototype%\n        \"RegExpPrototype\": _.RegExp.prototype,\n        // %Set%\n        \"Set\": _.Set,\n        // %SetIteratorPrototype%\n        \"SetIteratorPrototype\": undefined,\n        // %SetPrototype%\n        \"SetPrototype\": _.Set.prototype,\n        // %String%\n        \"String\": _.String,\n        // %StringIteratorPrototype%\n        \"StringIteratorPrototype\": anonymousStringIteratorPrototype,\n        // %StringPrototype%\n        \"StringPrototype\": _.String.prototype,\n        // %Symbol%\n        \"Symbol\": _.Symbol,\n        // %SymbolPrototype%\n        \"SymbolPrototype\": _.Symbol.prototype,\n        // %SyntaxError%\n        \"SyntaxError\": _.SyntaxError,\n        // %SyntaxErrorPrototype%\n        \"SyntaxErrorPrototype\": _.SyntaxError.prototype,\n        // %ThrowTypeError%\n        \"ThrowTypeError\": undefined,\n        // %TypedArray%\n        \"TypedArray\": undefined,\n        // %TypedArrayPrototype%\n        \"TypedArrayPrototype\": undefined,\n        // %TypeError%\n        \"TypeError\": _.TypeError,\n        // %TypeErrorPrototype%\n        \"TypeErrorPrototype\": _.TypeError.prototype,\n        // %Uint8Array%\n        \"Uint8Array\": _.Uint8Array,\n        // %Uint8ArrayPrototype%\n        \"Uint8ArrayPrototype\": _.Uint8Array.prototype,\n        // %Uint8ClampedArray%\n        \"Uint8ClampedArray\": _.Uint8ClampedArray,\n        // %Uint8ClampedArrayPrototype%\n        \"Uint8ClampedArrayPrototype\": _.Uint8ClampedArray.prototype,\n        // %Uint16Array%\n        \"Uint16Array\": _.Uint16Array,\n        // %Uint16ArrayPrototype%\n        \"Uint16ArrayPrototype\": Uint16Array.prototype,\n        // %Uint32Array%\n        \"Uint32Array\": _.Uint32Array,\n        // %Uint32ArrayPrototype%\n        \"Uint32ArrayPrototype\": _.Uint32Array.prototype,\n        // %URIError%\n        \"URIError\": _.URIError,\n        // %URIErrorPrototype%\n        \"URIErrorPrototype\": _.URIError.prototype,\n        // %WeakMap%\n        \"WeakMap\": _.WeakMap,\n        // %WeakMapPrototype%\n        \"WeakMapPrototype\": _.WeakMap.prototype,\n        // %WeakSet%\n        \"WeakSet\": _.WeakSet,\n        // %WeakSetPrototype%\n        \"WeakSetPrototype\": _.WeakSet.prototype,\n\n        // TODO: Annex B\n        // TODO: other special cases\n\n        // ESNext\n        global: globalObject,\n        Realm,\n    };\n}","import { getIntrinsics } from \"./intrinsics\";\n\nexport function getStdLib(sandbox) {\n    const intrinsics = getIntrinsics(sandbox);\n    return {\n        Array: { value: intrinsics.Array },\n        ArrayBuffer: { value: intrinsics.ArrayBuffer },\n        Boolean: { value: intrinsics.Boolean },\n        DataView: { value: intrinsics.DataView },\n        Date: { value: intrinsics.Date },\n        decodeURI: { value: intrinsics.decodeURI },\n        decodeURIComponent: { value: intrinsics.decodeURIComponent },\n        encodeURI: { value: intrinsics.encodeURI },\n        encodeURIComponent: { value: intrinsics.encodeURIComponent },\n        Error: { value: intrinsics.Error },\n        eval: { value: intrinsics.eval },\n        EvalError: { value: intrinsics.EvalError },\n        Float32Array: { value: intrinsics.Float32Array },\n        Float64Array: { value: intrinsics.Float64Array },\n        Function: { value: intrinsics.Function },\n        Int8Array: { value: intrinsics.Int8Array },\n        Int16Array: { value: intrinsics.Int16Array },\n        Int32Array: { value: intrinsics.Int32Array },\n        isFinite: { value: intrinsics.isFinite },\n        isNaN: { value: intrinsics.isNaN },\n        JSON: { value: intrinsics.JSON },\n        Map: { value: intrinsics.Map },\n        Math: { value: intrinsics.Math },\n        Number: { value: intrinsics.Number },\n        Object: { value: intrinsics.Object },\n        parseFloat: { value: intrinsics.parseFloat },\n        parseInt: { value: intrinsics.parseInt },\n        Promise: { value: intrinsics.Promise },\n        Proxy: { value: intrinsics.Proxy },\n        RangeError: { value: intrinsics.RangeError },\n        ReferenceError: { value: intrinsics.ReferenceError },\n        Reflect: { value: intrinsics.Reflect },\n        RegExp: { value: intrinsics.RegExp },\n        Set: { value: intrinsics.Set },\n        String: { value: intrinsics.String },\n        Symbol: { value: intrinsics.Symbol },\n        SyntaxError: { value: intrinsics.SyntaxError },\n        TypeError: { value: intrinsics.TypeError },\n        Uint8Array: { value: intrinsics.Uint8Array },\n        Uint8ClampedArray: { value: intrinsics.Uint8ClampedArray },\n        Uint16Array: { value: intrinsics.Uint16Array },\n        Uint32Array: { value: intrinsics.Uint32Array },\n        URIError: { value: intrinsics.URIError },\n        WeakMap: { value: intrinsics.WeakMap },\n        WeakSet: { value: intrinsics.WeakSet },\n\n        // TODO: Annex B\n        // TODO: other special cases\n\n        // ESNext\n        global: { value: intrinsics.global },\n        Realm: { value: intrinsics.Realm },\n    };\n}","import { createSandbox } from \"./sandbox\";\nimport { sanitize } from \"./sanitize\";\nimport { evaluate } from \"./evaluate\";\nimport { getEvaluators } from \"./evaluators\";\nimport { getStdLib } from \"./stdlib\";\nimport { getIntrinsics } from \"./intrinsics\";\nimport { proxyHandler } from \"./proxy\";\n\nconst RealmToSandbox = new WeakMap();\n\nfunction getSandbox(realm) {\n    const sandbox = RealmToSandbox.get(realm);\n    if (!sandbox) {\n        throw new Error(`Invalid realm object.`);\n    }\n    return sandbox;\n}\n\nexport default class Realm {\n\n    constructor(options = {}) {\n        const { thisValue, globalObj } = options;\n        const sandbox = createSandbox(globalObj, thisValue);\n        sanitize(sandbox);\n        Object.assign(sandbox, getEvaluators(sandbox));\n        // TODO: assert that RealmToSandbox does not have `this` entry\n        RealmToSandbox.set(this, sandbox);\n        sandbox.globalProxy = new Proxy(sandbox, proxyHandler);\n        this.init();\n    }\n\n    init() {\n        Object.defineProperties(this.global, this.stdlib);\n    }\n\n    eval(sourceText) {\n        const sandbox = getSandbox(this);\n        return evaluate(sourceText, sandbox);\n    }\n\n    get stdlib() {\n        const sandbox = getSandbox(this);\n        return getStdLib(sandbox);\n    }\n\n    get intrinsics() {\n        const sandbox = getSandbox(this);\n        return getIntrinsics(sandbox);\n    }\n\n    get global() {\n        const sandbox = getSandbox(this);\n        return sandbox.globalObject;\n    }\n\n    get thisValue() {\n        const sandbox = getSandbox(this);\n        return sandbox.thisValue;\n    }\n\n}\n\nRealm.toString = () => 'function Realm() { [shim code] }';"],"names":["createIframe","el","document","createElement","style","display","title","setAttribute","body","appendChild","createSandbox","customGlobalObj","customThisValue","iframe","iframeDocument","contentDocument","confinedWindow","contentWindow","globalObject","Object","create","undefined","sanitize","sandbox","o","defineProperty","prototype","key","fn","this","d","p","getOwnPropertyDescriptor","getPrototypeOf","get","set","seal","ignore","setInternalEvaluation","resetInternalEvaluation","addLexicalScopesToSource","sourceText","replace","HookFnName","evalAndReturn","iframeBody","script","type","createTextNode","removeChild","result","evaluate","apply","thisValue","globalProxy","getEvalEvaluator","setPrototypeOf","eval","Function","toString","getFunctionEvaluator","f","args","pop","join","constructor","getEvaluators","getIntrinsics","_","anonymousArrayIteratorPrototype","getProto","Array","iteratorSymbol","anonymousStringIteratorPrototype","String","anonymousIteratorPrototype","strictArgumentsGenerator","anonymousGenerator","anonymousGeneratorPrototype","anonymousGeneratorFunction","ArrayBuffer","values","Boolean","DataView","Date","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","Error","EvalError","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","isFinite","isNaN","JSON","Map","Math","Number","valueOf","parseFloat","parseInt","Promise","Proxy","RangeError","ReferenceError","Reflect","RegExp","Set","Symbol","SyntaxError","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","URIError","WeakMap","WeakSet","getStdLib","intrinsics","value","global","Realm","getSandbox","realm","RealmToSandbox","isInternalEvaluation","proxyHandler","propName","newValue","descriptor","deleteProperty","getOwnPropertyNames","iterator","options","globalObj","assign","init","defineProperties","stdlib"],"mappings":"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"}